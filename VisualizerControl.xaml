<UserControl x:Class="VisuAIlizer.VisualizerToolWindowControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
             mc:Ignorable="d"
             d:DesignHeight="720" d:DesignWidth="1200">

    <!-- ROOT -->
    <Grid Background="#071019" Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Header -->
            <RowDefinition Height="Auto"/>   <!-- Select project row -->
            <RowDefinition Height="Auto"/>   <!-- Buttons row -->
            <RowDefinition Height="*"/>      <!-- Diagram / WebView -->
        </Grid.RowDefinitions>

        <!-- ================= Header ================= -->
        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,8,0,18" HorizontalAlignment="Center">
            <TextBlock Text="Visu[AI]lizer" FontSize="28" FontWeight="Bold" 
                       Foreground="#9FF7FF" Opacity="0.95" HorizontalAlignment="Center"/>
            <TextBlock Text="Visualize code flow and architecture â€” generated & enriched by your local LLM"
                       FontSize="12" Foreground="#9FB7C0" Opacity="0.75" HorizontalAlignment="Center" Margin="0,6,0,0"/>
        </StackPanel>

        <!-- ================= Select Project Row ================= -->
        <Grid Grid.Row="1" Margin="6,0,6,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="12"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button x:Name="BtnSelectProject" Content="Select Project Location" Height="36" MinWidth="220" Grid.Column="0"
                    Style="{StaticResource FuturisticSmallButton}" Click="OnSelectProjectClick" />

            <TextBox x:Name="TxtProjectPath" Grid.Column="2" Height="32" VerticalContentAlignment="Center" 
                     IsReadOnly="True" Text="No project selected" Margin="0,0,4,0"
                     Background="#0B1220" Foreground="#E6F7F8" BorderBrush="#29414A" BorderThickness="1" Padding="8"/>
        </Grid>

        <!-- ================= Centered Buttons Row ================= -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,14" >
            <Button x:Name="BtnCodeFlow" Content="Code Flow" Width="180" Height="56" Margin="10,0"
                    Style="{StaticResource FuturisticButtonStyle}" Click="OnCodeFlowClick"/>
            <Button x:Name="BtnArchitecture" Content="Architecture Diagram" Width="240" Height="56" Margin="10,0"
                    Style="{StaticResource FuturisticButtonStyle}" Content="OnArchitectureClick"/>
        </StackPanel>

        <!-- ================= Diagram Area (WebView2) ================= -->
        <Border Grid.Row="3" CornerRadius="12" BorderThickness="1" BorderBrush="#18323A" Background="#071019" Padding="8">
            <!-- inside border we put a subtle glass panel and the webview -->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- small toolbar above the view (optional) -->
                <StackPanel Orientation="Horizontal" Grid.Row="0" HorizontalAlignment="Right" Margin="0,0,4,8">
                    <TextBlock Text="Diagram view" Foreground="#87D7E0" VerticalAlignment="Center" FontSize="12" Margin="0,0,12,0"/>
                    <!-- export / zoom icons could go here -->
                </StackPanel>

                <!-- the WebView2 fills the rest -->
                <wv2:WebView2 x:Name="WebPanel" Grid.Row="1" Margin="4" />
            </Grid>
        </Border>

        <!-- ================= Styles & Resources ================= -->
        <UserControl.Resources>

            <!-- SMALL button style used in select row -->
            <Style x:Key="FuturisticSmallButton" TargetType="Button">
                <Setter Property="Foreground" Value="#E8FFFF"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="#0E1B24" Offset="0"/>
                            <GradientStop Color="#091016" Offset="1"/>
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
                <Setter Property="BorderBrush" Value="#2BA6B0"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid>
                                <Border x:Name="b" CornerRadius="8" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#00f0ff" BlurRadius="8" ShadowDepth="0" Opacity="0.05"/>
                                    </Border.Effect>
                                </Border>
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="b" Property="BorderBrush" Value="#7FF6FF"/>
                                    <Setter TargetName="b" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#7FF6FF" BlurRadius="18" ShadowDepth="0" Opacity="0.18"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="b" Property="Opacity" Value="0.85"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- LARGE futuristic button style -->
            <Style x:Key="FuturisticButtonStyle" TargetType="Button">
                <Setter Property="Foreground" Value="#EFFFFF"/>
                <Setter Property="FontSize" Value="15"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Padding" Value="12,6"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="#13232A" Offset="0"/>
                            <GradientStop Color="#0B1518" Offset="1"/>
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
                <Setter Property="BorderBrush" Value="#3DE6E9"/>
                <Setter Property="BorderThickness" Value="1.5"/>

                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid>
                                <!-- outer glow ring -->
                                <Border x:Name="Glow" CornerRadius="18" BorderThickness="0" Background="{TemplateBinding Background}">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#3DE6E9" BlurRadius="0" ShadowDepth="0" Opacity="0.0"/>
                                    </Border.Effect>
                                </Border>

                                <!-- inner border -->
                                <Border x:Name="Panel" CornerRadius="18" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}">
                                    <Border.Padding>8</Border.Padding>
                                </Border>

                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>

                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Panel" Property="BorderBrush" Value="#9FF6FF"/>
                                    <Setter TargetName="Glow" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#9FF6FF" BlurRadius="28" ShadowDepth="0" Opacity="0.32"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="Panel" Property="RenderTransform">
                                        <Setter.Value>
                                            <TranslateTransform Y="1"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter TargetName="Panel" Property="Opacity" Value="0.92"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </UserControl.Resources>
    </Grid>
</UserControl>
